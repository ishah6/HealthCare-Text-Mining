From your symptoms it seems to me that you may be having irritable bowel 
syndrome. I would advice you to try an elimination diet , try and identify 
what foods or substances lead to increased symptoms and try to eliminate it 
from your diet . Also try and eat small meals as opposed to large meals 
which may stimulate your bowels more. Avoid foods and drinks which 
stimulate the intestines like coffee, hot drinks, wheat barley, rye, oats 
etc, Increase your intake of fresh fruits and vegetables as that will 
supply you with increased fibre. In severe cases you could try taking an 
antidiarrheal agent like loperamide when you are going out so as to avoid 
difficult situations socially. 